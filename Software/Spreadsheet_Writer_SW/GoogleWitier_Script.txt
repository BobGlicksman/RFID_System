function doGet(e) { 

  var ss = SpreadsheetApp.openByUrl("https://docs.google.com/spreadsheets/d/14SyVybExZ9JWzo8vl1pb5OmVbAASdGPHxLD1CHvmos4/edit?usp=drive_link");
  var sheet = ss.getSheetByName("Sheet1");

  addVisit(e,sheet);
}

function doPost(e) { 

  var ss = SpreadsheetApp.openByUrl("https://docs.google.com/spreadsheets/d/14SyVybExZ9JWzo8vl1pb5OmVbAASdGPHxLD1CHvmos4/edit?usp=drive_link");
  var sheet = ss.getSheetByName("Sheet1");

  addVisit(e,sheet);
}


function addVisit(e, sheet) {

  var edata = e.parameter.data;
  var visitData = JSON.parse(edata);

  var vDate = visitData.vDate; 
  var vFirstName = visitData.vFName;
  var vLastName = visitData.vLName;
  var vTour = visitData.vTour;
  var vClass = visitData.vClass;
  var vEvent = visitData.vEvent;
  var vVolun = visitData.vVolun;
  var vGuest = visitData.vGuest;
  var vForgot = visitData.vForgot;
  var vOther = visitData.vOther;
  var vHearAbout = visitData.vHearAbout;

  sheet.appendRow([vDate, vFirstName, vLastName, vTour, vClass, vEvent, vVolun, vGuest, vForgot, vOther, vHearAbout]);
  cleanUpSheet(sheet);  // keep the number of rows within bounds by deleting the oldest entries
}

function cleanUpSheet(sheet) {
  
  const MAX_ROWS = 2000;  // delete some rows if sheet has more than this
  const ROWS_TO_DELETE = 200;  // number of oldest rows to delete in a cleanup operation
  
  var lastRow = sheet.getLastRow();
  
  if(lastRow >= MAX_ROWS) {
    sheet.deleteRows(2, ROWS_TO_DELETE);
  }
  
}
